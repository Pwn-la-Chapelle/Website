<!doctype html><html lang=en-US class="scroll-smooth dark"><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Writeup – GPN CTF 2025: Paranoid</title>
<meta name=description content="LCG break via Babai's algorithm into nonce-reuse attack."><link rel=canonical href=https://pwn-la-chapelle.eu/posts/gpn2025_paranoid/><link rel=robots href=../../robots.txt><link rel=icon type=image/x-icon href=../../icons/favicon.ico><script defer>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script defer type=text/javascript id=MathJax-script src=https://pwn-la-chapelle.eu/mod/mathjax/tex-mml-chtml.7a1c82c2260a2f707b6f1fd7f97d2bb3524a17d00dcf08ce78ebc1ebd6283ce667a41842f46452bb6af2f6f02ebf8678eb4588ed8b788aad1d10f3de0849675c.js async></script><link rel=stylesheet href="https://pwn-la-chapelle.eu/css/app.min.24f431fa9c9ceec37387fedaeba0636fdfdd3d40aa4585cbc4134f2e1d49f719.css"><link rel=icon size=any href=../../img/pwn_logo_file_hu3111338654884279081.png><link rel=apple-touch-icon href=../../img/pwn_logo_file_hu3111338654884279081.png></head><body class="max-w-screen-md mx-auto"><div class=header><header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12"><div class="flex-none rounded-full overflow-hidden"><a href=https://pwn-la-chapelle.eu/><img srcset="../../img/pwn_logo_file_hu11041960313548565807.png 90w" src=../../img/pwn_logo_file.png width=2000 height=2000 alt=Pwn-la-Chapelle style=width:9rem></a></div><div class="flex flex-col gap-5"><div><a href=https://pwn-la-chapelle.eu/><h1 id=site-title>Pwn-la-Chapelle</h1></a><h5 id=site-description>Popping Shells and Stealing Flags at RWTH Aachen University</h5></div><nav><ul><li><a href=../../>Home</a></li><li><a href=../../about>About Us</a></li><li><a href=../../posts>Blog</a></li><li><button class=toggle-theme aria-label="Toggle Theme" title="Toggle Theme" onclick=toggleTheme()>
<span class="theme-icon light"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75.0 11-7.5.0 3.75 3.75.0 017.5.0z"/></svg> </span><span class="theme-icon dark"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718.0 0118 15.75c-5.385.0-9.75-4.365-9.75-9.75.0-1.33.266-2.597.748-3.752A9.753 9.753.0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753.0 009.002-5.998z"/></svg> </span></button>
<script>document.addEventListener("DOMContentLoaded",function(){var e=localStorage.getItem("theme");!e&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark",setTheme("dark")),setTheme(!e||e==="dark"?"dark":e)});function setTheme(e){const t=document.querySelector("html");localStorage.setItem("theme",e),e==="light"?(t.classList.contains("dark")&&document.querySelector("html").classList.remove("dark"),document.querySelector(".theme-icon.light").style.display="none",document.querySelector(".theme-icon.dark").style.display="block"):(t.classList.contains("dark")||document.querySelector("html").classList.add("dark"),document.querySelector(".theme-icon.dark").style.display="none",document.querySelector(".theme-icon.light").style.display="block")}function toggleTheme(){const e=localStorage.getItem("theme");setTheme(e==="light"?"dark":"light")}</script></li></ul></nav></div></header></div><section class="relative mb-10 overflow-hidden rounded-2xl border border-indigo-200/70 bg-gradient-to-r from-indigo-600 via-fuchsia-600 to-amber-500 text-white shadow-xl transition hover:shadow-2xl focus-within:shadow-2xl dark:border-indigo-400/40"><a href=https://haix-la-chapelle.eu class="group relative block px-6 pt-4 pb-4 sm:px-7 sm:pt-5 sm:pb-5 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/80 focus-visible:ring-offset-2 focus-visible:ring-offset-indigo-700" target=_blank rel="noreferrer noopener" aria-label="Haix-la-Chapelle 2025 CTF"><div class="absolute inset-0 opacity-25 blur-3xl transition group-hover:opacity-30" aria-hidden=true style="background:radial-gradient(circle at 20% 20%,rgba(255,255,255,.45),transparent 35%),radial-gradient(circle at 80% 0%,rgba(255,255,255,.35),transparent 28%),radial-gradient(circle at 60% 70%,rgba(255,255,255,.3),transparent 30%)"></div><div id=ctf-peeker class="pointer-events-none absolute top-0 right-[30%] hidden sm:block sm:h-32 sm:w-32 md:right-[26%] md:h-36 md:w-36"><img src=../../img/happy_printe.png alt class="h-full w-full object-contain object-top" loading=lazy decoding=async></div><script>(()=>{const e=document.getElementById("ctf-peeker");if(!e)return;const t=(e,t)=>Math.random()*(t-e)+e,s=t(8,42),o=t(12,26),i=t(0,360),a=t(8,18),n=t(6.5,24);e.style.top=`${s}%`,e.style.right=`${o}%`,e.style.width=`${n}rem`,e.style.height=`${n}rem`,e.style.transform=`translateY(-${a}%) rotate(${i}deg)`})()</script><div class="relative flex flex-col gap-4 sm:flex-row sm:items-center sm:gap-6"><div class="flex flex-col gap-2"><div class="mt-1 inline-flex items-center gap-2 self-start rounded-full bg-white/20 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-white/95 backdrop-blur transition group-hover:bg-white/25"><span class="h-2 w-2 rounded-full bg-emerald-300 shadow-[0_0_0_4px_rgba(16,185,129,0.35)]"></span>
Live Soon · 24h Jeopardy</div><div><p class="text-sm font-semibold text-white/90 sm:text-base">Haix-la-Chapelle 2025 - Online</p><p class="text-xl font-bold leading-tight sm:text-2xl">Starts 29 Nov · 10:00 CET</p><p class="mt-2 max-w-2xl text-sm text-white/85 sm:text-base">Join us for our first self hosted CTF, challenges in web, pwn, crypto, OSINT, and more!</p></div></div><div class="flex flex-col gap-3 text-sm items-center text-center"><span class="inline-flex items-center justify-center rounded-full bg-white/20 px-4 py-2 font-semibold text-white/95 transition group-hover:bg-white/25">Register on haix-la-chapelle.eu
</span><a href=https://ctftime.org/event/2951 class="inline-flex items-center gap-2 text-white/85 underline-offset-4 transition hover:text-white" target=_blank rel="noreferrer noopener">See details on CTFtime
<span aria-hidden=true class="text-lg transition group-hover:translate-x-0.5">↗</span></a></div></div></a></section><main id=content><article class="flex flex-col gap-10"><header class="flex flex-col gap-2"><h2 class=title-large>Writeup – GPN CTF 2025: Paranoid</h2><div class=meta>by
<a href=https://dorianko.ch target=_blank>doriank</a>
-
<time datetime="2025-06-22 12:00:00 +0000 UTC" title='Sun, Jun 22, 2025, 12:00 PM UTC'>2025-06-22
</time>-
Estimated reading time: 17 minutes</div></header><section><h2 id=challenge-overview>Challenge Overview</h2><ul><li><strong>Name</strong>: Paranoid</li><li><strong>Category</strong>: Crypto</li><li><strong>Points</strong>: 383/500</li><li><strong>Solves</strong>: 6</li><li><strong>Author</strong>: Alkalem</li><li><strong>Challenge Files</strong>: <a download=paranoid href=paranoid.tar.gz>paranoid.tar.gz</a></li><li><strong>Flag Format</strong>: <code>GPNCTF{…}</code></li></ul><p>We are presented with a pseudo-random number generator that implements a linear congruential generator (LCG) with parameters that are themselves randomly generated at program start.</p><style type=text/css>.highlight-wrapper{position:relative;transition:max-height .3s ease-out,overflow .3s ease-out;margin-bottom:20px}.highlight-link{position:absolute;bottom:-10px;right:10px;background:#00549f;color:#fff;padding:5px 10px;border-radius:4px;text-decoration:none;font-size:.9em;transition:background .3s ease-out}.highlight-link:hover{background:#0056b3}</style><script type=text/javascript>function toggle(e){e.preventDefault();var t=e.target,n=t.closest(".highlight-wrapper");t.innerHTML.includes("expand")||t.innerHTML.includes("show entire code")?(t.innerHTML="Click here to collapse",n.querySelector(".preview").style.display="none",n.querySelector(".full").style.display="block"):(t.innerHTML=t.dataset.expandText,n.querySelector(".preview").style.display="block",n.querySelector(".full").style.display="none")}document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".highlight-link a");e.forEach(function(e){e.addEventListener("click",toggle)})})</script><div class=highlight-wrapper><div class=highlight-before></div><div class=preview><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1>1</a></span><span>[<span style=color:#ff79c6>...</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2>2</a></span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>main</span>():
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3>3</a></span><span>[<span style=color:#ff79c6>...</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4>4</a></span><span>  MUL <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5>5</a></span><span>  ADD <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=6><a style=outline:none;text-decoration:none;color:inherit href=#6>6</a></span><span>  INITIAL <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=7><a style=outline:none;text-decoration:none;color:inherit href=#7>7</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=8><a style=outline:none;text-decoration:none;color:inherit href=#8>8</a></span><span>  rng <span style=color:#ff79c6>=</span> RNG(INITIAL, MODULUS, ADD, MUL)</span></span></code></pre></div></div><div class=full style=display:none><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-python data-lang=python><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1> 1</a></span><span><span style=color:#ff79c6>import</span> secrets
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2> 2</a></span><span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3> 3</a></span><span>MODULUS <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>**</span> <span style=color:#bd93f9>128</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>51</span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4> 4</a></span><span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5> 5</a></span><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>RNG</span>:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=6><a style=outline:none;text-decoration:none;color:inherit href=#6> 6</a></span><span>  <span style=color:#ff79c6>def</span> __init__(self, initial, modulus, add, mul):
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=7><a style=outline:none;text-decoration:none;color:inherit href=#7> 7</a></span><span>    self<span style=color:#ff79c6>.</span>modulus <span style=color:#ff79c6>=</span> modulus
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=8><a style=outline:none;text-decoration:none;color:inherit href=#8> 8</a></span><span>    self<span style=color:#ff79c6>.</span>state <span style=color:#ff79c6>=</span> initial
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=9><a style=outline:none;text-decoration:none;color:inherit href=#9> 9</a></span><span>    self<span style=color:#ff79c6>.</span>add <span style=color:#ff79c6>=</span> add
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=10><a style=outline:none;text-decoration:none;color:inherit href=#10>10</a></span><span>    self<span style=color:#ff79c6>.</span>mul <span style=color:#ff79c6>=</span> mul
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=11><a style=outline:none;text-decoration:none;color:inherit href=#11>11</a></span><span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=12><a style=outline:none;text-decoration:none;color:inherit href=#12>12</a></span><span>  <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>next</span>(self) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>int</span>:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=13><a style=outline:none;text-decoration:none;color:inherit href=#13>13</a></span><span>    out <span style=color:#ff79c6>=</span> self<span style=color:#ff79c6>.</span>state
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=14><a style=outline:none;text-decoration:none;color:inherit href=#14>14</a></span><span>    self<span style=color:#ff79c6>.</span>state <span style=color:#ff79c6>=</span> (self<span style=color:#ff79c6>.</span>state <span style=color:#ff79c6>*</span> self<span style=color:#ff79c6>.</span>mul <span style=color:#ff79c6>+</span> self<span style=color:#ff79c6>.</span>add) <span style=color:#ff79c6>%</span> self<span style=color:#ff79c6>.</span>modulus
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=15><a style=outline:none;text-decoration:none;color:inherit href=#15>15</a></span><span>    <span style=color:#ff79c6>return</span> out
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=16><a style=outline:none;text-decoration:none;color:inherit href=#16>16</a></span><span>  
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=17><a style=outline:none;text-decoration:none;color:inherit href=#17>17</a></span><span>  <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>reseed</span>(self, seed):
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=18><a style=outline:none;text-decoration:none;color:inherit href=#18>18</a></span><span>    self<span style=color:#ff79c6>.</span>state <span style=color:#ff79c6>+=</span> seed
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=19><a style=outline:none;text-decoration:none;color:inherit href=#19>19</a></span><span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=20><a style=outline:none;text-decoration:none;color:inherit href=#20>20</a></span><span>  <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>get_iv</span>(self) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>bytes</span>:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=21><a style=outline:none;text-decoration:none;color:inherit href=#21>21</a></span><span>    iv <span style=color:#ff79c6>=</span> self<span style=color:#ff79c6>.</span>next()
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=22><a style=outline:none;text-decoration:none;color:inherit href=#22>22</a></span><span>    
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=23><a style=outline:none;text-decoration:none;color:inherit href=#23>23</a></span><span>    <span style=color:#ff79c6>return</span> iv<span style=color:#ff79c6>.</span>to_bytes(<span style=color:#bd93f9>16</span>)
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=24><a style=outline:none;text-decoration:none;color:inherit href=#24>24</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=25><a style=outline:none;text-decoration:none;color:inherit href=#25>25</a></span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>main</span>():
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=26><a style=outline:none;text-decoration:none;color:inherit href=#26>26</a></span><span>  <span style=color:#ff79c6>with</span> <span style=color:#8be9fd;font-style:italic>open</span>(<span style=color:#f1fa8c>&#34;/flag&#34;</span>) <span style=color:#ff79c6>as</span> file:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=27><a style=outline:none;text-decoration:none;color:inherit href=#27>27</a></span><span>    FLAG <span style=color:#ff79c6>=</span> file<span style=color:#ff79c6>.</span>read()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>encode()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=28><a style=outline:none;text-decoration:none;color:inherit href=#28>28</a></span><span>  MUL <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=29><a style=outline:none;text-decoration:none;color:inherit href=#29>29</a></span><span>  ADD <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=30><a style=outline:none;text-decoration:none;color:inherit href=#30>30</a></span><span>  INITIAL <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=31><a style=outline:none;text-decoration:none;color:inherit href=#31>31</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=32><a style=outline:none;text-decoration:none;color:inherit href=#32>32</a></span><span>  rng <span style=color:#ff79c6>=</span> RNG(INITIAL, MODULUS, ADD, MUL)</span></span></code></pre></div></div><div class=highlight-link><a href style=text-decoration:none data-expand-text="Click here to expand">Click here to expand</a></div></div><p>Then, a random 128-bit key is generated and the flag is encrypted with AES in counter mode, with the IV being selected by the previously initialized LCG, and the resulting ciphertext is printed to the console.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1>1</a></span><span>  KEY <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>token_bytes(<span style=color:#bd93f9>16</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2>2</a></span><span>  aes <span style=color:#ff79c6>=</span> AES(KEY)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3>3</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4>4</a></span><span>  flag_ct <span style=color:#ff79c6>=</span> aes<span style=color:#ff79c6>.</span>encrypt_ctr(pad(FLAG), rng<span style=color:#ff79c6>.</span>get_iv())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5>5</a></span><span>  <span style=color:#8be9fd;font-style:italic>print</span>(flag_ct<span style=color:#ff79c6>.</span>hex())</span></span></code></pre></div></p><p>Finally, we are prompted to enter a plaintext, which the program will graciously encrypt for us as it did with the flag before, but using the next random value from the LCG as IV. Crucially though, it adds the first byte of the plaintext as a number to the internal state of the LCG.
<script type=text/javascript>function toggle(e){e.preventDefault();var t=e.target,n=t.closest(".highlight-wrapper");t.innerHTML.includes("expand")||t.innerHTML.includes("show entire code")?(t.innerHTML="Click here to collapse",n.querySelector(".preview").style.display="none",n.querySelector(".full").style.display="block"):(t.innerHTML=t.dataset.expandText,n.querySelector(".preview").style.display="block",n.querySelector(".full").style.display="none")}document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".highlight-link a");e.forEach(function(e){e.addEventListener("click",toggle)})})</script><div class=highlight-wrapper><div class=highlight-before></div><div class=preview><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1>1</a></span><span>[<span style=color:#ff79c6>...</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2>2</a></span><span>    <span style=color:#ff79c6>while</span> <span style=color:#ff79c6>True</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3>3</a></span><span>      plaintext <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(<span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4>4</a></span><span>[<span style=color:#ff79c6>...</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5>5</a></span><span>      ciphertext <span style=color:#ff79c6>=</span> aes<span style=color:#ff79c6>.</span>encrypt_ctr(pad(plaintext), rng<span style=color:#ff79c6>.</span>get_iv())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=6><a style=outline:none;text-decoration:none;color:inherit href=#6>6</a></span><span>      <span style=color:#8be9fd;font-style:italic>print</span>(ciphertext<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=7><a style=outline:none;text-decoration:none;color:inherit href=#7>7</a></span><span>      rng<span style=color:#ff79c6>.</span>reseed(<span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(plaintext[:<span style=color:#bd93f9>1</span>])) <span style=color:#6272a4># &lt;--- This is the vulnerability!</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=8><a style=outline:none;text-decoration:none;color:inherit href=#8>8</a></span><span>[<span style=color:#ff79c6>...</span>]</span></span></code></pre></div></div><div class=full style=display:none><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-python data-lang=python><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1> 1</a></span><span>  <span style=color:#ff79c6>try</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2> 2</a></span><span>    <span style=color:#ff79c6>while</span> <span style=color:#ff79c6>True</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3> 3</a></span><span>      plaintext <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(<span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>))
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4> 4</a></span><span>      <span style=color:#ff79c6>if</span> <span style=color:#8be9fd;font-style:italic>len</span>(plaintext) <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>**</span> <span style=color:#bd93f9>16</span>:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5> 5</a></span><span>        <span style=color:#ff79c6>raise</span> ValueError(<span style=color:#f1fa8c>&#34;nah&#34;</span>)
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=6><a style=outline:none;text-decoration:none;color:inherit href=#6> 6</a></span><span>      
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=7><a style=outline:none;text-decoration:none;color:inherit href=#7> 7</a></span><span>      ciphertext <span style=color:#ff79c6>=</span> aes<span style=color:#ff79c6>.</span>encrypt_ctr(pad(plaintext), rng<span style=color:#ff79c6>.</span>get_iv())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=8><a style=outline:none;text-decoration:none;color:inherit href=#8> 8</a></span><span>      <span style=color:#8be9fd;font-style:italic>print</span>(ciphertext<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=9><a style=outline:none;text-decoration:none;color:inherit href=#9> 9</a></span><span>      rng<span style=color:#ff79c6>.</span>reseed(<span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(plaintext[:<span style=color:#bd93f9>1</span>])) <span style=color:#6272a4># &lt;--- This is the vulnerability!</span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=10><a style=outline:none;text-decoration:none;color:inherit href=#10>10</a></span><span>  <span style=color:#ff79c6>except</span> EOFError:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=11><a style=outline:none;text-decoration:none;color:inherit href=#11>11</a></span><span>    <span style=color:#ff79c6>pass</span> <span style=color:#6272a4># remote disconnected, exit</span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=12><a style=outline:none;text-decoration:none;color:inherit href=#12>12</a></span><span>  <span style=color:#ff79c6>except</span>:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=13><a style=outline:none;text-decoration:none;color:inherit href=#13>13</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;terminated due to error&#34;</span>)</span></span></code></pre></div></div><div class=highlight-link><a href style=text-decoration:none data-expand-text="Click here to expand">Click here to expand</a></div></div></p><h2 id=the-idea>The Idea</h2><p>This is how CTR mode encryption works:
<img alt=CTR-Mode src=../../posts/gpn2025_paranoid/CTR_encryption_2.svg title=CTR-Mode></p><p>The IV (called Nonce in the picture above) is encrypted via the block cipher (in this case AES) and then XORed with the plaintext. If we know the plaintext to a particular ciphertext, we can trivially recover the keystream by XORing the two, therefore it is essential that an IV is never reused after a plaintext has been encrypted with it.</p><p>In our case, the IV is determined by an LCG. If we can alter its state in such a way that it generates the IV of the flag ciphertext again, we can encrypt our own plaintext with the same IV, recover the keystream via XOR and use it to decrypt the flag ciphertext! <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=step-1-reverse-engineering-the-lcg>Step 1: Reverse engineering the LCG</h2><p>Before we can alter the LCG state to produce the IV we want, we need to recover its parameters.</p><p>Recall that the LCG is created as follows:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1>1</a></span><span>  MUL <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2>2</a></span><span>  ADD <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3>3</a></span><span>  INITIAL <span style=color:#ff79c6>=</span> secrets<span style=color:#ff79c6>.</span>randbelow(MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4>4</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5>5</a></span><span>  rng <span style=color:#ff79c6>=</span> RNG(INITIAL, MODULUS, ADD, MUL)</span></span></code></pre></div></p><p>Luckily for us, we can recover all the parameters with just three values of the LCG! The IV is always saved as the first block of a CTR mode ciphertext, so to retrieve our three LCG values, we can use the flag ciphertext IV, and generate two more ciphertexts with a plaintext of zeros as to not modify the internal LCG state with <code>rng.reseed(…)</code>.</p><p>From the RNG source code we extract the following equations:</p>\[
\begin{aligned}
\text{iv}_0 &:= \text{INITIAL} \\
\text{iv}_{i+1} &:= \text{iv}_i \cdot \text{MUL} + \text{ADD} \text{ (mod MODULUS)}
\end{aligned}
\]<p>For simplicity I will abbreviate $N := \text{MODULUS}$, $m := \text{MUL}$ and $a := \text{ADD}$</p><p>We arrive at the following system of equations for our three IVs:</p>\[
\begin{aligned}
\text{iv}_0 &= \text{INITIAL} \\
\text{iv}_{1} &= \text{iv}_0 \cdot m + a &\text{ (mod $N$)} \\
\text{iv}_{2} &= (\text{iv}_0 \cdot m + a) \cdot m + a &\text{ (mod $N$)} \\
 &= \text{iv}_0 \cdot m^2 + a \cdot m + a &\text{ (mod $N$)}
\end{aligned}
\]<p>And after some algebra that is left as an exercise to the reader, we can express $a$ and $m$ in terms of the three IVs:</p>\[
\begin{aligned}
m &= (\text{iv}_2 - \text{iv}_1) \cdot (\text{iv}_1 - \text{iv}_0)^{-1} &\text{ (mod $N$)} \\
a &= \text{iv}_1 - \text{iv}_0 \cdot m &\text{ (mod $N$)} \\
\end{aligned}
\]<p>Because $N$ is prime, we can always uniquely recover the parameters and state of the RNG, and proceed to the next step.</p><h2 id=step-2-reproducing-the-iv>Step 2: Reproducing the IV</h2><p>Our LCG definition from the previous step had a small omission: the reseed parameter.
Recall: the first byte of the plaintext is added to the internal state of the LCG, and we will use this to control the LCG state to produce the IV we want. But let&rsquo;s first model this additional parameter mathematically:</p>\[
\begin{aligned}
\text{LCG}(x) &:= x\cdot m + a &\text{ (mod $N$)} \\
\text{iv}_0 &:= \text{INITIAL} + d_0  \\
\text{iv}_{i + 1} &:= \text{LCG}(\text{iv}_i) + d_{i+1} \\
\text{with } d_i &\in [0, 255] \text{ for all } i \\
\end{aligned}
\]<p>Here, LCG is the LCG function we derived in the previous step, and the $d_i$ are the reseed values, which are determined by the first byte of the plaintext we encrypt. In our case $d_i = 0$ for $i \in \{0, 1, 2\}$, because we used a plaintext of zeros to retrieve the IVs.</p><p>Our goal:</p>\[
\begin{aligned}\
\text{Find } d_0, d_1, &\dots, d_i \text{ such that }& \\
\text{iv}_i &\equiv \text{flag_iv} &\text{ (mod $N$)} \\
\end{aligned}
\]<p>Note what happens when we simplify multiple iterations of the LCG with reseed values:</p>\[
\begin{aligned}
\text{iv}_1 &= LCG(\text{iv}_0) + d_1 &\text{ (mod $N$)} \\
\text{iv}_2 &= LCG(\text{iv}_1) + d_2 &\text{ (mod $N$)} \\
&= LCG(LCG(\text{iv}_0) + d_1) + d_2 &\text{ (mod $N$)} \\
            &= ((\text{iv}_0 \cdot m + a + d_1) \cdot m + a) + d_2 &\text{ (mod $N$)} \\
            &= ((\text{iv}_0 \cdot m + a) \cdot m + a) + d_1 \cdot m + d_2 &\text{ (mod $N$)} \\
            &= LCG(LCG(\text{iv}_0)) + d_1 \cdot m + d_2 &\text{ (mod $N$)} \\
            \vdots \\
\text{iv}_i &= LCG^{(i)}(\text{iv}_0) + \sum_{j=1}^{i} d_j \cdot m^{i-j} &\text{ (mod $N$)} \\
\end{aligned}
\]<p>Now our problem of reproducing the IV is reduced to finding suitable $d_0, d_1, \dots, d_i$ such that the following equation holds:</p>\[
\begin{aligned}
LCG^{(i)}(\text{iv}_0) + \sum_{j=1}^{i} d_j \cdot m^{i-j} \equiv \text{flag_iv} &\text{ (mod $N$)}
\end{aligned}
\]<p>This is just a linear equation in the $d_j$ variables!</p><h2 id=step-3-solving-the-equation>Step 3: Solving the equation</h2>\[
\begin{aligned}
\sum_{j=1}^{i} d_j \cdot m^{i-j} \equiv \text{flag_iv} - LCG^{(i)}(\text{iv}_0) &\text{ (mod $N$)}
\end{aligned}
\]<p>Finding a solution to the equation above is quite trivial if the constraints $d_i \in [0, 255]$ are ignored. We could simply set $d_{i} = \text{flag_iv} - LCG^{(i)}(\text{iv}_0)$, and be done. But what we are looking for, is a <em>small</em> solution, one that does not exceed the bounds of $[0, 255]$ for every $d_j$.</p><p>There is a general solution to this problem, called the Coppersmith method for multivariate polynomials. With it, one can solve for <em>small</em> roots of modular polynomial equations, with small meaning that the range of the variables is bounded. You can find an implementation of it <a href=https://github.com/defund/coppersmith>here</a>. In this case though, the resulting lattice Matrix explodes in size with the high number of variables, and I was only able to solve up to $i = 8$ on my laptop, which is still roughly 64 bits<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> away from the flag IV, so I had to use a different approach.</p><p>In the following section I will describe how I solved the problem using a Lattice and Babai&rsquo;s nearest plane algorithm. If these terms are unfamiliar to you, I recommend reading <a href=https://jgeralnik.github.io/writeups/2021/08/12/Lattices/>this article</a> and <a href=https://eprint.iacr.org/2023/032>this paper</a> first.</p><p>In essence, we construct a lattice in which each vector corresponds to a solution of the equation above. We then apply Babai&rsquo;s nearest plane algorithm to find a vector whose components satisfy $d_j \in [0, 255]$ for all $j$.</p><p>A vector in the lattice will look like this:</p>\[
\begin{aligned}
k &:= \text{flag_iv} - LCG^{(i)}(\text{iv}_0) \\
L &:= \textit{"a large value"} \\
   v &= \left(d_1, \dots, d_i, j_1 k - \sum_{j=1}^{i} d_j \cdot m^{i-j} + j_2 N, j_1 L\right) \in \mathbb{Z}^{i+2} \\
&\text{with $j_1$, $j_2$}\in \mathbb{Z} \\
\end{aligned}
\]<p>This vector is constructed such that the first $i$ components correspond to the $d_j$ values we are looking for, the next component is the difference between $\text{iv}_i$ and $\text{flag_iv}$, and the last component is a large value which we will use to control the size of $j_1$. $j_2$ is necessary because our equation is modulo $N$ and not over all the integers.</p><p>Note that we do not need $L$ for the solution, but rather we couple it with $k$ to force $j_1$ to be small (ideally equal to 1) when we search for a small vector in the lattice. Also note that the first few $d_j$ will be zero due to our method of reverse engineering the LCG and can thus be omitted, but this is a minor implementation detail.</p><p>The first vector of our lattice basis is quite obvious:</p>\[
\begin{aligned}
b_0 &= (0, \dots, 0, k, L) \\
\end{aligned}
\]<p>Intuitively, this vector corresponds to the case $d_j = 0$ for all $j$, which results in $\text{iv}_i \equiv LCG^{(i)}(\text{iv}_0)$.</p><p>Then we encode the linear operation of the $d_j$ values:</p>\[
\begin{aligned}
b_1 &= (1, 0, \dots, 0, - m^{i-1}, 0) \\
b_2 &= (0, 1, \dots, 0, - m^{i-2}, 0) \\
&\vdots \\
b_i &= (0, 0, \dots, 1, - m^{i-i}, 0) \\
\end{aligned}
\]<p>These follow immediately from the vector definition above.</p><p>The last basis vector is responsible for modular arithmetic:</p>\[
\begin{aligned}
b_{i+1} &= (0, \dots, 0, N, 0)
\end{aligned}
\]<p>This encodes the fact that $k \equiv k + j_2 N$ (mod $N$) for any integer $j_2$.</p><p>The solution vector that we are looking for will have the form:</p>\[
\begin{aligned}
v &= (d_1, d_2, \dots, d_i, 0, L) \\
\text{with } d_j &\in [0, 255] \text{ for all } j \\
\end{aligned}
\]<p>i.e. we are looking for those $d_j$ that satisfy $1 \cdot k - \sum_{j=1}^{i} d_j \cdot m^{i-j} \equiv 0\text{ (mod $N$)}$.</p><p>Because the second to last component is so much larger than all other components (as can be seen by the basis vectors), the shortest non-zero vector in this lattice will almost surely be the solution we are looking for<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. Unfortunately, a <em>small</em> vector is not guaranteed to have components in $[0, 255]$ but is more likely to be centered around zero and thus include negative values for some $d_j$. This is why we apply Babai&rsquo;s nearest plane algorithm to find the closest vector not to the origin $0$, but to $127$ for all the $d_j$ components.</p><p>Our final Babai target vector looks like this:</p>\[
\begin{aligned}
t &= (127, 127, \dots, 127, 0, L)
\end{aligned}
\]<p>By setting $L = 255^{2}$ and iterating $i = 1,\dots,20$ in the implementation, we can reliably find a solution vector in about a second.</p><blockquote><p>Recovered flag: GPNCTF{iF_YOU_w4nNa_BE_pArAnoid,yOu_G0T_t0_bE_GooD}</p></blockquote><h2 id=the-implementation>The Implementation</h2><p>This is my solve script implemented in SageMath. It differs slightly from the writeup because it made the explanation here simpler, but the core logic is the same.
In the script, the $d_j$ are sorted in reverse order, and there is some additional logic to handle the first few $d_j$ being zero. The order of the basis vectors is also slightly different.
If you have any questions about the implementation, feel free to @ me on discord, you can find the invite on the homepage of this blog.</p><script type=text/javascript>function toggle(e){e.preventDefault();var t=e.target,n=t.closest(".highlight-wrapper");t.innerHTML.includes("expand")||t.innerHTML.includes("show entire code")?(t.innerHTML="Click here to collapse",n.querySelector(".preview").style.display="none",n.querySelector(".full").style.display="block"):(t.innerHTML=t.dataset.expandText,n.querySelector(".preview").style.display="block",n.querySelector(".full").style.display="none")}document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".highlight-link a");e.forEach(function(e){e.addEventListener("click",toggle)})})</script><div class=highlight-wrapper><div class=highlight-before></div><div class=preview><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1>  1</a></span><span>[<span style=color:#ff79c6>...</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2>  2</a></span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>attack</span>():
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3>  3</a></span><span>    p <span style=color:#ff79c6>=</span> remote(<span style=color:#f1fa8c>&#34;greenwind-of-epic-victory.gpn23.ctf.kitctf.de&#34;</span>, <span style=color:#f1fa8c>&#34;443&#34;</span>, ssl<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4>  4</a></span><span>    flag_ct <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5>  5</a></span><span>    flag_ct <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(flag_ct)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=6><a style=outline:none;text-decoration:none;color:inherit href=#6>  6</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Flag ciphertext:&#34;</span>, flag_ct<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=7><a style=outline:none;text-decoration:none;color:inherit href=#7>  7</a></span><span>    flag_iv <span style=color:#ff79c6>=</span> flag_ct[:<span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=8><a style=outline:none;text-decoration:none;color:inherit href=#8>  8</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=9><a style=outline:none;text-decoration:none;color:inherit href=#9>  9</a></span><span>    p<span style=color:#ff79c6>.</span>sendlineafter(<span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;00&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=10><a style=outline:none;text-decoration:none;color:inherit href=#10> 10</a></span><span>    a2 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode())[:<span style=color:#ff79c6>-</span><span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=11><a style=outline:none;text-decoration:none;color:inherit href=#11> 11</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;a2:&#34;</span>, a2<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=12><a style=outline:none;text-decoration:none;color:inherit href=#12> 12</a></span><span>    p<span style=color:#ff79c6>.</span>sendlineafter(<span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;00&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=13><a style=outline:none;text-decoration:none;color:inherit href=#13> 13</a></span><span>    a3 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode())[:<span style=color:#ff79c6>-</span><span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=14><a style=outline:none;text-decoration:none;color:inherit href=#14> 14</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;a3:&#34;</span>, a3<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=15><a style=outline:none;text-decoration:none;color:inherit href=#15> 15</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=16><a style=outline:none;text-decoration:none;color:inherit href=#16> 16</a></span><span>    <span style=color:#6272a4># reconstruct the RNG</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=17><a style=outline:none;text-decoration:none;color:inherit href=#17> 17</a></span><span>    a1 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(flag_iv, <span style=color:#f1fa8c>&#34;big&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=18><a style=outline:none;text-decoration:none;color:inherit href=#18> 18</a></span><span>    a2 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(a2, <span style=color:#f1fa8c>&#34;big&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=19><a style=outline:none;text-decoration:none;color:inherit href=#19> 19</a></span><span>    a3 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(a3, <span style=color:#f1fa8c>&#34;big&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=20><a style=outline:none;text-decoration:none;color:inherit href=#20> 20</a></span><span>    mul <span style=color:#ff79c6>=</span> (a3 <span style=color:#ff79c6>-</span> a2) <span style=color:#ff79c6>*</span> <span style=color:#8be9fd;font-style:italic>pow</span>(a2 <span style=color:#ff79c6>-</span> a1, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, MODULUS) <span style=color:#ff79c6>%</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=21><a style=outline:none;text-decoration:none;color:inherit href=#21> 21</a></span><span>    add <span style=color:#ff79c6>=</span> (a2 <span style=color:#ff79c6>-</span> a1 <span style=color:#ff79c6>*</span> mul) <span style=color:#ff79c6>%</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=22><a style=outline:none;text-decoration:none;color:inherit href=#22> 22</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;mul: </span><span style=color:#f1fa8c>{</span>mul<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>, add: </span><span style=color:#f1fa8c>{</span>add<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> reconstructed&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=23><a style=outline:none;text-decoration:none;color:inherit href=#23> 23</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=24><a style=outline:none;text-decoration:none;color:inherit href=#24> 24</a></span><span>    found_valid_sol <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=25><a style=outline:none;text-decoration:none;color:inherit href=#25> 25</a></span><span>    valid_sol <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>None</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=26><a style=outline:none;text-decoration:none;color:inherit href=#26> 26</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=27><a style=outline:none;text-decoration:none;color:inherit href=#27> 27</a></span><span>    <span style=color:#6272a4># test different lengths of paths</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=28><a style=outline:none;text-decoration:none;color:inherit href=#28> 28</a></span><span>    <span style=color:#ff79c6>for</span> iv_num <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>20</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=29><a style=outline:none;text-decoration:none;color:inherit href=#29> 29</a></span><span>        <span style=color:#ff79c6>if</span> found_valid_sol:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=30><a style=outline:none;text-decoration:none;color:inherit href=#30> 30</a></span><span>            <span style=color:#ff79c6>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=31><a style=outline:none;text-decoration:none;color:inherit href=#31> 31</a></span><span>        <span style=color:#6272a4># now we have reconstructed the RNG</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=32><a style=outline:none;text-decoration:none;color:inherit href=#32> 32</a></span><span>        local_rng <span style=color:#ff79c6>=</span> RNG(a1, MODULUS, add, mul)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=33><a style=outline:none;text-decoration:none;color:inherit href=#33> 33</a></span><span>        <span style=color:#ff79c6>assert</span> local_rng<span style=color:#ff79c6>.</span>next() <span style=color:#ff79c6>==</span> a1
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=34><a style=outline:none;text-decoration:none;color:inherit href=#34> 34</a></span><span>        <span style=color:#ff79c6>assert</span> local_rng<span style=color:#ff79c6>.</span>next() <span style=color:#ff79c6>==</span> a2
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=35><a style=outline:none;text-decoration:none;color:inherit href=#35> 35</a></span><span>        <span style=color:#ff79c6>assert</span> local_rng<span style=color:#ff79c6>.</span>next() <span style=color:#ff79c6>==</span> a3
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=36><a style=outline:none;text-decoration:none;color:inherit href=#36> 36</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=37><a style=outline:none;text-decoration:none;color:inherit href=#37> 37</a></span><span>        <span style=color:#6272a4># calculate lcg^{iv_num}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=38><a style=outline:none;text-decoration:none;color:inherit href=#38> 38</a></span><span>        ivs <span style=color:#ff79c6>=</span> []
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=39><a style=outline:none;text-decoration:none;color:inherit href=#39> 39</a></span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=40><a style=outline:none;text-decoration:none;color:inherit href=#40> 40</a></span><span>            ivs<span style=color:#ff79c6>.</span>append(local_rng<span style=color:#ff79c6>.</span>next())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=41><a style=outline:none;text-decoration:none;color:inherit href=#41> 41</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=42><a style=outline:none;text-decoration:none;color:inherit href=#42> 42</a></span><span>        <span style=color:#6272a4># Construct lattice for modular equation</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=43><a style=outline:none;text-decoration:none;color:inherit href=#43> 43</a></span><span>        M <span style=color:#ff79c6>=</span> Matrix(ZZ, iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>, iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=44><a style=outline:none;text-decoration:none;color:inherit href=#44> 44</a></span><span>        <span style=color:#6272a4># target vector for babais algorithm, we need this because our solution needs to be strictly positive</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=45><a style=outline:none;text-decoration:none;color:inherit href=#45> 45</a></span><span>        <span style=color:#6272a4># so we search for a solution around 127 (because we need 0-255)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=46><a style=outline:none;text-decoration:none;color:inherit href=#46> 46</a></span><span>        targetVector <span style=color:#ff79c6>=</span> vector(ZZ, iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=47><a style=outline:none;text-decoration:none;color:inherit href=#47> 47</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=48><a style=outline:none;text-decoration:none;color:inherit href=#48> 48</a></span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(iv_num):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=49><a style=outline:none;text-decoration:none;color:inherit href=#49> 49</a></span><span>            M[i, i] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=50><a style=outline:none;text-decoration:none;color:inherit href=#50> 50</a></span><span>            M[i, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>-</span><span style=color:#8be9fd;font-style:italic>pow</span>(mul, i, MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=51><a style=outline:none;text-decoration:none;color:inherit href=#51> 51</a></span><span>            targetVector[i] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>127</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=52><a style=outline:none;text-decoration:none;color:inherit href=#52> 52</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=53><a style=outline:none;text-decoration:none;color:inherit href=#53> 53</a></span><span>        largeVal <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>255</span> <span style=color:#ff79c6>^</span> <span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=54><a style=outline:none;text-decoration:none;color:inherit href=#54> 54</a></span><span>        M[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> (a1 <span style=color:#ff79c6>-</span> ivs[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>]) <span style=color:#ff79c6>%</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=55><a style=outline:none;text-decoration:none;color:inherit href=#55> 55</a></span><span>        M[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> largeVal
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=56><a style=outline:none;text-decoration:none;color:inherit href=#56> 56</a></span><span>        M[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=57><a style=outline:none;text-decoration:none;color:inherit href=#57> 57</a></span><span>        targetVector[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=58><a style=outline:none;text-decoration:none;color:inherit href=#58> 58</a></span><span>        targetVector[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> largeVal
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=59><a style=outline:none;text-decoration:none;color:inherit href=#59> 59</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=60><a style=outline:none;text-decoration:none;color:inherit href=#60> 60</a></span><span>        <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>test_sol</span>(row):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=61><a style=outline:none;text-decoration:none;color:inherit href=#61> 61</a></span><span>            <span style=color:#6272a4># just some helper func to see if our sol is valid</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=62><a style=outline:none;text-decoration:none;color:inherit href=#62> 62</a></span><span>            <span style=color:#ff79c6>nonlocal</span> valid_sol, found_valid_sol
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=63><a style=outline:none;text-decoration:none;color:inherit href=#63> 63</a></span><span>            test_rng <span style=color:#ff79c6>=</span> RNG(a1, MODULUS, add, mul)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=64><a style=outline:none;text-decoration:none;color:inherit href=#64> 64</a></span><span>            <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>3</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=65><a style=outline:none;text-decoration:none;color:inherit href=#65> 65</a></span><span>                test_rng<span style=color:#ff79c6>.</span>next()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=66><a style=outline:none;text-decoration:none;color:inherit href=#66> 66</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=67><a style=outline:none;text-decoration:none;color:inherit href=#67> 67</a></span><span>            <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(iv_num):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=68><a style=outline:none;text-decoration:none;color:inherit href=#68> 68</a></span><span>                iv_val <span style=color:#ff79c6>=</span> test_rng<span style=color:#ff79c6>.</span>next()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=69><a style=outline:none;text-decoration:none;color:inherit href=#69> 69</a></span><span>                test_rng<span style=color:#ff79c6>.</span>reseed(row[iv_num <span style=color:#ff79c6>-</span> i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=70><a style=outline:none;text-decoration:none;color:inherit href=#70> 70</a></span><span>            iv_val <span style=color:#ff79c6>=</span> test_rng<span style=color:#ff79c6>.</span>next()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=71><a style=outline:none;text-decoration:none;color:inherit href=#71> 71</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=72><a style=outline:none;text-decoration:none;color:inherit href=#72> 72</a></span><span>            <span style=color:#ff79c6>if</span> iv_val <span style=color:#ff79c6>==</span> a1:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=73><a style=outline:none;text-decoration:none;color:inherit href=#73> 73</a></span><span>                <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Found m_vals: </span><span style=color:#f1fa8c>{</span>row<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=74><a style=outline:none;text-decoration:none;color:inherit href=#74> 74</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=75><a style=outline:none;text-decoration:none;color:inherit href=#75> 75</a></span><span>                <span style=color:#ff79c6>if</span> <span style=color:#8be9fd;font-style:italic>all</span>(x <span style=color:#ff79c6>&gt;=</span> <span style=color:#bd93f9>0</span> <span style=color:#ff79c6>and</span> x <span style=color:#ff79c6>&lt;=</span> <span style=color:#bd93f9>255</span> <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> row[:<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>]):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=76><a style=outline:none;text-decoration:none;color:inherit href=#76> 76</a></span><span>                    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Found a valid solution!&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=77><a style=outline:none;text-decoration:none;color:inherit href=#77> 77</a></span><span>                    valid_sol <span style=color:#ff79c6>=</span> row
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=78><a style=outline:none;text-decoration:none;color:inherit href=#78> 78</a></span><span>                    found_valid_sol <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=79><a style=outline:none;text-decoration:none;color:inherit href=#79> 79</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=80><a style=outline:none;text-decoration:none;color:inherit href=#80> 80</a></span><span>        someVec <span style=color:#ff79c6>=</span> babai(M, targetVector)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=81><a style=outline:none;text-decoration:none;color:inherit href=#81> 81</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Babai vec: &#34;</span>, someVec)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=82><a style=outline:none;text-decoration:none;color:inherit href=#82> 82</a></span><span>        <span style=color:#6272a4># because the last reseed value has a tiny influence, we brute force its value here</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=83><a style=outline:none;text-decoration:none;color:inherit href=#83> 83</a></span><span>        <span style=color:#ff79c6>for</span> testval <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>255</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=84><a style=outline:none;text-decoration:none;color:inherit href=#84> 84</a></span><span>            someVec[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> testval
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=85><a style=outline:none;text-decoration:none;color:inherit href=#85> 85</a></span><span>            test_sol(someVec<span style=color:#ff79c6>.</span>list())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=86><a style=outline:none;text-decoration:none;color:inherit href=#86> 86</a></span><span>            <span style=color:#ff79c6>if</span> found_valid_sol:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=87><a style=outline:none;text-decoration:none;color:inherit href=#87> 87</a></span><span>                <span style=color:#ff79c6>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=88><a style=outline:none;text-decoration:none;color:inherit href=#88> 88</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=89><a style=outline:none;text-decoration:none;color:inherit href=#89> 89</a></span><span>    <span style=color:#ff79c6>assert</span> found_valid_sol, <span style=color:#f1fa8c>&#34;No valid solution found&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=90><a style=outline:none;text-decoration:none;color:inherit href=#90> 90</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Valid solution found:&#34;</span>, valid_sol)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=91><a style=outline:none;text-decoration:none;color:inherit href=#91> 91</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=92><a style=outline:none;text-decoration:none;color:inherit href=#92> 92</a></span><span>    <span style=color:#6272a4># Now we send the reseed values to the server</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=93><a style=outline:none;text-decoration:none;color:inherit href=#93> 93</a></span><span>    iv_num <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>len</span>(valid_sol) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=94><a style=outline:none;text-decoration:none;color:inherit href=#94> 94</a></span><span>    <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(valid_sol) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>2</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=95><a style=outline:none;text-decoration:none;color:inherit href=#95> 95</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;m_</span><span style=color:#f1fa8c>{</span>i<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> = </span><span style=color:#f1fa8c>{</span>valid_sol[i]<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=96><a style=outline:none;text-decoration:none;color:inherit href=#96> 96</a></span><span>        seed_thing <span style=color:#ff79c6>=</span> valid_sol[iv_num <span style=color:#ff79c6>-</span> i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=97><a style=outline:none;text-decoration:none;color:inherit href=#97> 97</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Reseeding with </span><span style=color:#f1fa8c>{</span>seed_thing<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=98><a style=outline:none;text-decoration:none;color:inherit href=#98> 98</a></span><span>        p<span style=color:#ff79c6>.</span>sendlineafter(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=99><a style=outline:none;text-decoration:none;color:inherit href=#99> 99</a></span><span>            <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#8be9fd;font-style:italic>bytes</span>([seed_thing])<span style=color:#ff79c6>.</span>hex()<span style=color:#ff79c6>.</span>encode()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=100><a style=outline:none;text-decoration:none;color:inherit href=#100>100</a></span><span>        )
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=101><a style=outline:none;text-decoration:none;color:inherit href=#101>101</a></span><span>    <span style=color:#6272a4># now this is the crucial one, the next encryption will use the flag iv</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=102><a style=outline:none;text-decoration:none;color:inherit href=#102>102</a></span><span>    <span style=color:#6272a4># so we send a plaintext of all zeros, which will give us the keystream for the flag iv</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=103><a style=outline:none;text-decoration:none;color:inherit href=#103>103</a></span><span>    p<span style=color:#ff79c6>.</span>sendlineafter(<span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;00&#34;</span> <span style=color:#ff79c6>*</span> <span style=color:#8be9fd;font-style:italic>len</span>(flag_ct))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=104><a style=outline:none;text-decoration:none;color:inherit href=#104>104</a></span><span>    uncipher_block <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=105><a style=outline:none;text-decoration:none;color:inherit href=#105>105</a></span><span>    uncipher_block <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(uncipher_block)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=106><a style=outline:none;text-decoration:none;color:inherit href=#106>106</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=107><a style=outline:none;text-decoration:none;color:inherit href=#107>107</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Unciphered block:&#34;</span>, uncipher_block<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=108><a style=outline:none;text-decoration:none;color:inherit href=#108>108</a></span><span>    <span style=color:#ff79c6>if</span> uncipher_block[:<span style=color:#bd93f9>16</span>] <span style=color:#ff79c6>!=</span> flag_iv:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=109><a style=outline:none;text-decoration:none;color:inherit href=#109>109</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Failed to uncipher the flag block&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=110><a style=outline:none;text-decoration:none;color:inherit href=#110>110</a></span><span>        <span style=color:#ff79c6>return</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=111><a style=outline:none;text-decoration:none;color:inherit href=#111>111</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=112><a style=outline:none;text-decoration:none;color:inherit href=#112>112</a></span><span>    all_text <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=113><a style=outline:none;text-decoration:none;color:inherit href=#113>113</a></span><span>    <span style=color:#ff79c6>for</span> block <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(flag_ct) <span style=color:#ff79c6>//</span> <span style=color:#bd93f9>16</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=114><a style=outline:none;text-decoration:none;color:inherit href=#114>114</a></span><span>        flag_block <span style=color:#ff79c6>=</span> uncipher_block[block <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span> : (block <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=115><a style=outline:none;text-decoration:none;color:inherit href=#115>115</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=116><a style=outline:none;text-decoration:none;color:inherit href=#116>116</a></span><span>        flag_block <span style=color:#ff79c6>=</span> xor_bytes(flag_block, flag_ct[(block) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span> : (block <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=117><a style=outline:none;text-decoration:none;color:inherit href=#117>117</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=118><a style=outline:none;text-decoration:none;color:inherit href=#118>118</a></span><span>            <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Flag block </span><span style=color:#f1fa8c>{</span>block<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>: </span><span style=color:#f1fa8c>{</span>flag_block<span style=color:#ff79c6>.</span>hex()<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> </span><span style=color:#f1fa8c>{</span>flag_block<span style=color:#ff79c6>.</span>decode(errors<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;ignore&#39;</span>)<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=119><a style=outline:none;text-decoration:none;color:inherit href=#119>119</a></span><span>        )
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=120><a style=outline:none;text-decoration:none;color:inherit href=#120>120</a></span><span>        all_text <span style=color:#ff79c6>+=</span> flag_block<span style=color:#ff79c6>.</span>decode(errors<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;ignore&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=121><a style=outline:none;text-decoration:none;color:inherit href=#121>121</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Recovered flag:&#34;</span>, all_text<span style=color:#ff79c6>.</span>strip())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=122><a style=outline:none;text-decoration:none;color:inherit href=#122>122</a></span><span>[<span style=color:#ff79c6>...</span>]</span></span></code></pre></div></div><div class=full style=display:none><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-python data-lang=python><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1>  1</a></span><span><span style=color:#ff79c6>from</span> pwn <span style=color:#ff79c6>import</span> <span style=color:#ff79c6>*</span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2>  2</a></span><span><span style=color:#ff79c6>from</span> challenge <span style=color:#ff79c6>import</span> RNG, MODULUS
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3>  3</a></span><span><span style=color:#ff79c6>from</span> aes <span style=color:#ff79c6>import</span> xor_bytes
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4>  4</a></span><span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5>  5</a></span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>babai</span>(A, w):
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=6><a style=outline:none;text-decoration:none;color:inherit href=#6>  6</a></span><span>    A <span style=color:#ff79c6>=</span> A<span style=color:#ff79c6>.</span>LLL()
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=7><a style=outline:none;text-decoration:none;color:inherit href=#7>  7</a></span><span>    G <span style=color:#ff79c6>=</span> A<span style=color:#ff79c6>.</span>gram_schmidt()[<span style=color:#bd93f9>0</span>]
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=8><a style=outline:none;text-decoration:none;color:inherit href=#8>  8</a></span><span>    t <span style=color:#ff79c6>=</span> w
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=9><a style=outline:none;text-decoration:none;color:inherit href=#9>  9</a></span><span>    <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>reversed</span>(<span style=color:#8be9fd;font-style:italic>range</span>(A<span style=color:#ff79c6>.</span>nrows())):
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=10><a style=outline:none;text-decoration:none;color:inherit href=#10> 10</a></span><span>        c <span style=color:#ff79c6>=</span> ((t <span style=color:#ff79c6>*</span> G[i]) <span style=color:#ff79c6>/</span> (G[i] <span style=color:#ff79c6>*</span> G[i]))<span style=color:#ff79c6>.</span>round()
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=11><a style=outline:none;text-decoration:none;color:inherit href=#11> 11</a></span><span>        t <span style=color:#ff79c6>-=</span> A[i] <span style=color:#ff79c6>*</span> c
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=12><a style=outline:none;text-decoration:none;color:inherit href=#12> 12</a></span><span>    <span style=color:#ff79c6>return</span> w <span style=color:#ff79c6>-</span> t
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=13><a style=outline:none;text-decoration:none;color:inherit href=#13> 13</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=14><a style=outline:none;text-decoration:none;color:inherit href=#14> 14</a></span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>attack</span>():
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=15><a style=outline:none;text-decoration:none;color:inherit href=#15> 15</a></span><span>    p <span style=color:#ff79c6>=</span> remote(<span style=color:#f1fa8c>&#34;greenwind-of-epic-victory.gpn23.ctf.kitctf.de&#34;</span>, <span style=color:#f1fa8c>&#34;443&#34;</span>, ssl<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=16><a style=outline:none;text-decoration:none;color:inherit href=#16> 16</a></span><span>    flag_ct <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=17><a style=outline:none;text-decoration:none;color:inherit href=#17> 17</a></span><span>    flag_ct <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(flag_ct)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=18><a style=outline:none;text-decoration:none;color:inherit href=#18> 18</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Flag ciphertext:&#34;</span>, flag_ct<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=19><a style=outline:none;text-decoration:none;color:inherit href=#19> 19</a></span><span>    flag_iv <span style=color:#ff79c6>=</span> flag_ct[:<span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=20><a style=outline:none;text-decoration:none;color:inherit href=#20> 20</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=21><a style=outline:none;text-decoration:none;color:inherit href=#21> 21</a></span><span>    p<span style=color:#ff79c6>.</span>sendlineafter(<span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;00&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=22><a style=outline:none;text-decoration:none;color:inherit href=#22> 22</a></span><span>    a2 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode())[:<span style=color:#ff79c6>-</span><span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=23><a style=outline:none;text-decoration:none;color:inherit href=#23> 23</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;a2:&#34;</span>, a2<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=24><a style=outline:none;text-decoration:none;color:inherit href=#24> 24</a></span><span>    p<span style=color:#ff79c6>.</span>sendlineafter(<span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;00&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=25><a style=outline:none;text-decoration:none;color:inherit href=#25> 25</a></span><span>    a3 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode())[:<span style=color:#ff79c6>-</span><span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=26><a style=outline:none;text-decoration:none;color:inherit href=#26> 26</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;a3:&#34;</span>, a3<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=27><a style=outline:none;text-decoration:none;color:inherit href=#27> 27</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=28><a style=outline:none;text-decoration:none;color:inherit href=#28> 28</a></span><span>    <span style=color:#6272a4># reconstruct the RNG</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=29><a style=outline:none;text-decoration:none;color:inherit href=#29> 29</a></span><span>    a1 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(flag_iv, <span style=color:#f1fa8c>&#34;big&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=30><a style=outline:none;text-decoration:none;color:inherit href=#30> 30</a></span><span>    a2 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(a2, <span style=color:#f1fa8c>&#34;big&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=31><a style=outline:none;text-decoration:none;color:inherit href=#31> 31</a></span><span>    a3 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>int</span><span style=color:#ff79c6>.</span>from_bytes(a3, <span style=color:#f1fa8c>&#34;big&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=32><a style=outline:none;text-decoration:none;color:inherit href=#32> 32</a></span><span>    mul <span style=color:#ff79c6>=</span> (a3 <span style=color:#ff79c6>-</span> a2) <span style=color:#ff79c6>*</span> <span style=color:#8be9fd;font-style:italic>pow</span>(a2 <span style=color:#ff79c6>-</span> a1, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, MODULUS) <span style=color:#ff79c6>%</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=33><a style=outline:none;text-decoration:none;color:inherit href=#33> 33</a></span><span>    add <span style=color:#ff79c6>=</span> (a2 <span style=color:#ff79c6>-</span> a1 <span style=color:#ff79c6>*</span> mul) <span style=color:#ff79c6>%</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=34><a style=outline:none;text-decoration:none;color:inherit href=#34> 34</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;mul: </span><span style=color:#f1fa8c>{</span>mul<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>, add: </span><span style=color:#f1fa8c>{</span>add<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> reconstructed&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=35><a style=outline:none;text-decoration:none;color:inherit href=#35> 35</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=36><a style=outline:none;text-decoration:none;color:inherit href=#36> 36</a></span><span>    found_valid_sol <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=37><a style=outline:none;text-decoration:none;color:inherit href=#37> 37</a></span><span>    valid_sol <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>None</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=38><a style=outline:none;text-decoration:none;color:inherit href=#38> 38</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=39><a style=outline:none;text-decoration:none;color:inherit href=#39> 39</a></span><span>    <span style=color:#6272a4># test different lengths of paths</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=40><a style=outline:none;text-decoration:none;color:inherit href=#40> 40</a></span><span>    <span style=color:#ff79c6>for</span> iv_num <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>20</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=41><a style=outline:none;text-decoration:none;color:inherit href=#41> 41</a></span><span>        <span style=color:#ff79c6>if</span> found_valid_sol:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=42><a style=outline:none;text-decoration:none;color:inherit href=#42> 42</a></span><span>            <span style=color:#ff79c6>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=43><a style=outline:none;text-decoration:none;color:inherit href=#43> 43</a></span><span>        <span style=color:#6272a4># now we have reconstructed the RNG</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=44><a style=outline:none;text-decoration:none;color:inherit href=#44> 44</a></span><span>        local_rng <span style=color:#ff79c6>=</span> RNG(a1, MODULUS, add, mul)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=45><a style=outline:none;text-decoration:none;color:inherit href=#45> 45</a></span><span>        <span style=color:#ff79c6>assert</span> local_rng<span style=color:#ff79c6>.</span>next() <span style=color:#ff79c6>==</span> a1
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=46><a style=outline:none;text-decoration:none;color:inherit href=#46> 46</a></span><span>        <span style=color:#ff79c6>assert</span> local_rng<span style=color:#ff79c6>.</span>next() <span style=color:#ff79c6>==</span> a2
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=47><a style=outline:none;text-decoration:none;color:inherit href=#47> 47</a></span><span>        <span style=color:#ff79c6>assert</span> local_rng<span style=color:#ff79c6>.</span>next() <span style=color:#ff79c6>==</span> a3
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=48><a style=outline:none;text-decoration:none;color:inherit href=#48> 48</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=49><a style=outline:none;text-decoration:none;color:inherit href=#49> 49</a></span><span>        <span style=color:#6272a4># calculate lcg^{iv_num}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=50><a style=outline:none;text-decoration:none;color:inherit href=#50> 50</a></span><span>        ivs <span style=color:#ff79c6>=</span> []
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=51><a style=outline:none;text-decoration:none;color:inherit href=#51> 51</a></span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=52><a style=outline:none;text-decoration:none;color:inherit href=#52> 52</a></span><span>            ivs<span style=color:#ff79c6>.</span>append(local_rng<span style=color:#ff79c6>.</span>next())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=53><a style=outline:none;text-decoration:none;color:inherit href=#53> 53</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=54><a style=outline:none;text-decoration:none;color:inherit href=#54> 54</a></span><span>        <span style=color:#6272a4># Construct lattice for modular equation</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=55><a style=outline:none;text-decoration:none;color:inherit href=#55> 55</a></span><span>        M <span style=color:#ff79c6>=</span> Matrix(ZZ, iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>, iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=56><a style=outline:none;text-decoration:none;color:inherit href=#56> 56</a></span><span>        <span style=color:#6272a4># target vector for babais algorithm, we need this because our solution needs to be strictly positive</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=57><a style=outline:none;text-decoration:none;color:inherit href=#57> 57</a></span><span>        <span style=color:#6272a4># so we search for a solution around 127 (because we need 0-255)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=58><a style=outline:none;text-decoration:none;color:inherit href=#58> 58</a></span><span>        targetVector <span style=color:#ff79c6>=</span> vector(ZZ, iv_num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=59><a style=outline:none;text-decoration:none;color:inherit href=#59> 59</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=60><a style=outline:none;text-decoration:none;color:inherit href=#60> 60</a></span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(iv_num):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=61><a style=outline:none;text-decoration:none;color:inherit href=#61> 61</a></span><span>            M[i, i] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=62><a style=outline:none;text-decoration:none;color:inherit href=#62> 62</a></span><span>            M[i, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>-</span><span style=color:#8be9fd;font-style:italic>pow</span>(mul, i, MODULUS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=63><a style=outline:none;text-decoration:none;color:inherit href=#63> 63</a></span><span>            targetVector[i] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>127</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=64><a style=outline:none;text-decoration:none;color:inherit href=#64> 64</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=65><a style=outline:none;text-decoration:none;color:inherit href=#65> 65</a></span><span>        largeVal <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>255</span> <span style=color:#ff79c6>^</span> <span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=66><a style=outline:none;text-decoration:none;color:inherit href=#66> 66</a></span><span>        M[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> (a1 <span style=color:#ff79c6>-</span> ivs[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>]) <span style=color:#ff79c6>%</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=67><a style=outline:none;text-decoration:none;color:inherit href=#67> 67</a></span><span>        M[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> largeVal
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=68><a style=outline:none;text-decoration:none;color:inherit href=#68> 68</a></span><span>        M[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> MODULUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=69><a style=outline:none;text-decoration:none;color:inherit href=#69> 69</a></span><span>        targetVector[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=70><a style=outline:none;text-decoration:none;color:inherit href=#70> 70</a></span><span>        targetVector[<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> largeVal
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=71><a style=outline:none;text-decoration:none;color:inherit href=#71> 71</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=72><a style=outline:none;text-decoration:none;color:inherit href=#72> 72</a></span><span>        <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>test_sol</span>(row):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=73><a style=outline:none;text-decoration:none;color:inherit href=#73> 73</a></span><span>            <span style=color:#6272a4># just some helper func to see if our sol is valid</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=74><a style=outline:none;text-decoration:none;color:inherit href=#74> 74</a></span><span>            <span style=color:#ff79c6>nonlocal</span> valid_sol, found_valid_sol
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=75><a style=outline:none;text-decoration:none;color:inherit href=#75> 75</a></span><span>            test_rng <span style=color:#ff79c6>=</span> RNG(a1, MODULUS, add, mul)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=76><a style=outline:none;text-decoration:none;color:inherit href=#76> 76</a></span><span>            <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>3</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=77><a style=outline:none;text-decoration:none;color:inherit href=#77> 77</a></span><span>                test_rng<span style=color:#ff79c6>.</span>next()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=78><a style=outline:none;text-decoration:none;color:inherit href=#78> 78</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=79><a style=outline:none;text-decoration:none;color:inherit href=#79> 79</a></span><span>            <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(iv_num):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=80><a style=outline:none;text-decoration:none;color:inherit href=#80> 80</a></span><span>                iv_val <span style=color:#ff79c6>=</span> test_rng<span style=color:#ff79c6>.</span>next()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=81><a style=outline:none;text-decoration:none;color:inherit href=#81> 81</a></span><span>                test_rng<span style=color:#ff79c6>.</span>reseed(row[iv_num <span style=color:#ff79c6>-</span> i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=82><a style=outline:none;text-decoration:none;color:inherit href=#82> 82</a></span><span>            iv_val <span style=color:#ff79c6>=</span> test_rng<span style=color:#ff79c6>.</span>next()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=83><a style=outline:none;text-decoration:none;color:inherit href=#83> 83</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=84><a style=outline:none;text-decoration:none;color:inherit href=#84> 84</a></span><span>            <span style=color:#ff79c6>if</span> iv_val <span style=color:#ff79c6>==</span> a1:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=85><a style=outline:none;text-decoration:none;color:inherit href=#85> 85</a></span><span>                <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Found m_vals: </span><span style=color:#f1fa8c>{</span>row<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=86><a style=outline:none;text-decoration:none;color:inherit href=#86> 86</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=87><a style=outline:none;text-decoration:none;color:inherit href=#87> 87</a></span><span>                <span style=color:#ff79c6>if</span> <span style=color:#8be9fd;font-style:italic>all</span>(x <span style=color:#ff79c6>&gt;=</span> <span style=color:#bd93f9>0</span> <span style=color:#ff79c6>and</span> x <span style=color:#ff79c6>&lt;=</span> <span style=color:#bd93f9>255</span> <span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> row[:<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>]):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=88><a style=outline:none;text-decoration:none;color:inherit href=#88> 88</a></span><span>                    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Found a valid solution!&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=89><a style=outline:none;text-decoration:none;color:inherit href=#89> 89</a></span><span>                    valid_sol <span style=color:#ff79c6>=</span> row
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=90><a style=outline:none;text-decoration:none;color:inherit href=#90> 90</a></span><span>                    found_valid_sol <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=91><a style=outline:none;text-decoration:none;color:inherit href=#91> 91</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=92><a style=outline:none;text-decoration:none;color:inherit href=#92> 92</a></span><span>        someVec <span style=color:#ff79c6>=</span> babai(M, targetVector)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=93><a style=outline:none;text-decoration:none;color:inherit href=#93> 93</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Babai vec: &#34;</span>, someVec)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=94><a style=outline:none;text-decoration:none;color:inherit href=#94> 94</a></span><span>        <span style=color:#6272a4># because the last reseed value has a tiny influence, we brute force its value here</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=95><a style=outline:none;text-decoration:none;color:inherit href=#95> 95</a></span><span>        <span style=color:#ff79c6>for</span> testval <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>255</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=96><a style=outline:none;text-decoration:none;color:inherit href=#96> 96</a></span><span>            someVec[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> testval
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=97><a style=outline:none;text-decoration:none;color:inherit href=#97> 97</a></span><span>            test_sol(someVec<span style=color:#ff79c6>.</span>list())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=98><a style=outline:none;text-decoration:none;color:inherit href=#98> 98</a></span><span>            <span style=color:#ff79c6>if</span> found_valid_sol:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=99><a style=outline:none;text-decoration:none;color:inherit href=#99> 99</a></span><span>                <span style=color:#ff79c6>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=100><a style=outline:none;text-decoration:none;color:inherit href=#100>100</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=101><a style=outline:none;text-decoration:none;color:inherit href=#101>101</a></span><span>    <span style=color:#ff79c6>assert</span> found_valid_sol, <span style=color:#f1fa8c>&#34;No valid solution found&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=102><a style=outline:none;text-decoration:none;color:inherit href=#102>102</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Valid solution found:&#34;</span>, valid_sol)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=103><a style=outline:none;text-decoration:none;color:inherit href=#103>103</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=104><a style=outline:none;text-decoration:none;color:inherit href=#104>104</a></span><span>    <span style=color:#6272a4># Now we send the reseed values to the server</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=105><a style=outline:none;text-decoration:none;color:inherit href=#105>105</a></span><span>    iv_num <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>len</span>(valid_sol) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=106><a style=outline:none;text-decoration:none;color:inherit href=#106>106</a></span><span>    <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(valid_sol) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>2</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=107><a style=outline:none;text-decoration:none;color:inherit href=#107>107</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;m_</span><span style=color:#f1fa8c>{</span>i<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> = </span><span style=color:#f1fa8c>{</span>valid_sol[i]<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=108><a style=outline:none;text-decoration:none;color:inherit href=#108>108</a></span><span>        seed_thing <span style=color:#ff79c6>=</span> valid_sol[iv_num <span style=color:#ff79c6>-</span> i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=109><a style=outline:none;text-decoration:none;color:inherit href=#109>109</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Reseeding with </span><span style=color:#f1fa8c>{</span>seed_thing<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=110><a style=outline:none;text-decoration:none;color:inherit href=#110>110</a></span><span>        p<span style=color:#ff79c6>.</span>sendlineafter(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=111><a style=outline:none;text-decoration:none;color:inherit href=#111>111</a></span><span>            <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#8be9fd;font-style:italic>bytes</span>([seed_thing])<span style=color:#ff79c6>.</span>hex()<span style=color:#ff79c6>.</span>encode()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=112><a style=outline:none;text-decoration:none;color:inherit href=#112>112</a></span><span>        )
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=113><a style=outline:none;text-decoration:none;color:inherit href=#113>113</a></span><span>    <span style=color:#6272a4># now this is the crucial one, the next encryption will use the flag iv</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=114><a style=outline:none;text-decoration:none;color:inherit href=#114>114</a></span><span>    <span style=color:#6272a4># so we send a plaintext of all zeros, which will give us the keystream for the flag iv</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=115><a style=outline:none;text-decoration:none;color:inherit href=#115>115</a></span><span>    p<span style=color:#ff79c6>.</span>sendlineafter(<span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Give me something to encrypt (hex):&#34;</span>, <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;00&#34;</span> <span style=color:#ff79c6>*</span> <span style=color:#8be9fd;font-style:italic>len</span>(flag_ct))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=116><a style=outline:none;text-decoration:none;color:inherit href=#116>116</a></span><span>    uncipher_block <span style=color:#ff79c6>=</span> p<span style=color:#ff79c6>.</span>recvline()<span style=color:#ff79c6>.</span>strip()<span style=color:#ff79c6>.</span>decode()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=117><a style=outline:none;text-decoration:none;color:inherit href=#117>117</a></span><span>    uncipher_block <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytes</span><span style=color:#ff79c6>.</span>fromhex(uncipher_block)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=118><a style=outline:none;text-decoration:none;color:inherit href=#118>118</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=119><a style=outline:none;text-decoration:none;color:inherit href=#119>119</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Unciphered block:&#34;</span>, uncipher_block<span style=color:#ff79c6>.</span>hex())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=120><a style=outline:none;text-decoration:none;color:inherit href=#120>120</a></span><span>    <span style=color:#ff79c6>if</span> uncipher_block[:<span style=color:#bd93f9>16</span>] <span style=color:#ff79c6>!=</span> flag_iv:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=121><a style=outline:none;text-decoration:none;color:inherit href=#121>121</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Failed to uncipher the flag block&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=122><a style=outline:none;text-decoration:none;color:inherit href=#122>122</a></span><span>        <span style=color:#ff79c6>return</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=123><a style=outline:none;text-decoration:none;color:inherit href=#123>123</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=124><a style=outline:none;text-decoration:none;color:inherit href=#124>124</a></span><span>    all_text <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=125><a style=outline:none;text-decoration:none;color:inherit href=#125>125</a></span><span>    <span style=color:#ff79c6>for</span> block <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(flag_ct) <span style=color:#ff79c6>//</span> <span style=color:#bd93f9>16</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=126><a style=outline:none;text-decoration:none;color:inherit href=#126>126</a></span><span>        flag_block <span style=color:#ff79c6>=</span> uncipher_block[block <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span> : (block <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=127><a style=outline:none;text-decoration:none;color:inherit href=#127>127</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=128><a style=outline:none;text-decoration:none;color:inherit href=#128>128</a></span><span>        flag_block <span style=color:#ff79c6>=</span> xor_bytes(flag_block, flag_ct[(block) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span> : (block <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=129><a style=outline:none;text-decoration:none;color:inherit href=#129>129</a></span><span>        <span style=color:#8be9fd;font-style:italic>print</span>(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=130><a style=outline:none;text-decoration:none;color:inherit href=#130>130</a></span><span>            <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Flag block </span><span style=color:#f1fa8c>{</span>block<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>: </span><span style=color:#f1fa8c>{</span>flag_block<span style=color:#ff79c6>.</span>hex()<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> </span><span style=color:#f1fa8c>{</span>flag_block<span style=color:#ff79c6>.</span>decode(errors<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;ignore&#39;</span>)<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=131><a style=outline:none;text-decoration:none;color:inherit href=#131>131</a></span><span>        )
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=132><a style=outline:none;text-decoration:none;color:inherit href=#132>132</a></span><span>        all_text <span style=color:#ff79c6>+=</span> flag_block<span style=color:#ff79c6>.</span>decode(errors<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;ignore&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=133><a style=outline:none;text-decoration:none;color:inherit href=#133>133</a></span><span>    <span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Recovered flag:&#34;</span>, all_text<span style=color:#ff79c6>.</span>strip())
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=134><a style=outline:none;text-decoration:none;color:inherit href=#134>134</a></span><span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=135><a style=outline:none;text-decoration:none;color:inherit href=#135>135</a></span><span>
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=136><a style=outline:none;text-decoration:none;color:inherit href=#136>136</a></span><span><span style=color:#ff79c6>if</span> __name__ <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;__main__&#34;</span>:
</span></span><span style=display:flex;background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=137><a style=outline:none;text-decoration:none;color:inherit href=#137>137</a></span><span>    attack()</span></span></code></pre></div></div><div class=highlight-link><a href style=text-decoration:none data-expand-text="Click here to expand">Click here to expand</a></div></div><h2 id=conclusion>Conclusion</h2><p>Don&rsquo;t let the user reseed your PRNG with arbitrary values!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Because CTR mode is symmetric, you could also immediately submit the flag ciphertext to the program, and the &ldquo;encrypted&rdquo; output will be the flag plaintext!&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Intuitively, each $d_j$ approximately increases the space of reachable IVs by a factor of 256, because $d_j$ can take any value in $[0, 255]$. Because $\text{flag_iv} \in [0, N] = [0, 2^{128} + 51]$, we need $i \approx 16$ to be able to reach the flag IV from our state.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>This is not entirely true; Look again at the basis vector $b_i$. Because its influence on the second to last component is so small, it is possible that the solution we are looking for is the shortest vector in the lattice plus or minus a multiple of $b_i$. For this reason, I simply loop through all possible values of $d_i$ in my implementation as a workaround.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><footer><div class="pb-14 taxonomy-list tags-list"><a href=../../tags/crypto/ alt=Crypto>Crypto
</a><a href=../../tags/prng/ alt=PRNG>PRNG
</a><a href=../../tags/lattice/ alt=Lattice>Lattice
</a><a href=../../tags/writeup/ alt=Writeup>Writeup</a></div></footer></article></main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2"><div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">© 2025 —
<a href=https://pwn-la-chapelle.eu/>Pwn-la-Chapelle</a>
<span class=font-normal>with</span>
<a href=https://github.com/nixentric/Lowkey-Hugo-Theme target=_blank rel="noopener noreferrer">Lowkey</a></div><div class="order-1 sm:order-2"><ul class="flex sm:justify-end gap-5"><li><a href=../../posts/index.xml target=_blank rel="me noopener noreferrer">RSS</a></li><li><a href=../../imprint target=_blank rel="me noopener noreferrer">Imprint</a></li><li><a href=https://infosec.exchange/@pwn_la_chapelle target=_blank rel="me noopener noreferrer">Mastodon</a></li><li><a href=https://github.com/Pwn-la-Chapelle target=_blank rel="me noopener noreferrer">GitHub</a></li><li><a href=https://ctftime.org/team/279433 target=_blank rel="me noopener noreferrer">CTFTime</a></li></ul></div></footer></body><svg display="none" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="icon-rss" viewBox="0 0 1024 1024"><title>rss</title><path class="path1" d="M122.88 122.88v121.19c362.803.0 656.896 294.195 656.896 656.998h121.293c0-429.773-348.416-778.189-778.189-778.189zm0 242.534v121.293c228.813.0 414.362 185.498 414.362 414.413h121.242c0-295.834-239.821-535.706-535.603-535.706zM239.053 668.621c-64.205.0-116.224 52.122-116.224 116.275S174.848 901.12 239.053 901.12s116.173-52.019 116.173-116.224-51.968-116.275-116.173-116.275z"/></symbol><symbol id="icon-facebook" viewBox="0 0 1024 1024"><title>facebook</title><path class="path1" d="M870.4 51.2H153.6c-56.32.0-102.4 46.08-102.4 102.4v716.8c0 56.371 46.08 102.4 102.4 102.4H512V614.4H409.6V487.68H512V382.72c0-110.797 62.054-188.621 192.819-188.621l92.314.102v133.376h-61.286c-50.893.0-70.246 38.195-70.246 73.626v86.528h131.482L768.001 614.4h-102.4v358.4h204.8c56.32.0 102.4-46.029 102.4-102.4V153.6c0-56.32-46.08-102.4-102.4-102.4z"/></symbol><symbol id="icon-twitter" viewBox="0 0 1024 1024"><title>twitter</title><path class="path1" d="M886.579 319.795c.41 8.294.563 16.691.563 24.986.0 255.488-194.406 549.99-549.888 549.99-109.21.0-210.739-32-296.294-86.886 15.155 1.792 30.515 2.714 46.08 2.714 90.624.0 173.926-30.925 240.026-82.688-84.531-1.587-155.955-57.395-180.531-134.195 11.776 2.202 23.91 3.379 36.352 3.379 17.664.0 34.765-2.304 50.944-6.707-88.422-17.818-155.034-95.898-155.034-189.594.0-.819.0-1.587.0-2.406 26.061 14.49 55.91 23.194 87.552 24.218-51.866-34.714-86.016-93.798-86.016-160.922.0-35.379 9.523-68.608 26.214-97.178C201.83 281.498 344.32 358.4 504.934 366.49c-3.277-14.182-4.966-28.877-4.966-44.083.0-106.701 86.477-193.178 193.229-193.178 55.603.0 105.83 23.398 141.107 60.979 43.981-8.704 85.35-24.781 122.726-46.899-14.438 45.107-45.107 82.995-84.992 106.906 39.117-4.71 76.288-15.002 111.002-30.413-25.907 38.81-58.675 72.806-96.461 99.994z"/></symbol><symbol id="icon-github" viewBox="0 0 1024 1024"><title>github</title><path class="path1" d="M674.816 579.021c-36.762.0-66.56 41.318-66.56 92.109.0 50.893 29.798 92.211 66.56 92.211s66.56-41.318 66.56-92.211c-.051-50.79-29.798-92.109-66.56-92.109zm231.731-239.77c7.629-18.688 7.936-124.877-32.512-226.611.0.0-92.723 10.189-233.011 106.496-29.44-8.192-79.258-12.186-128.973-12.186-49.818.0-99.584 3.994-129.024 12.186C242.688 122.829 149.965 112.64 149.965 112.64c-40.397 101.734-39.987 207.923-32.461 226.611-47.514 51.61-76.544 113.613-76.544 198.195.0 367.923 305.306 373.811 382.31 373.811 17.51.0 52.122.102 88.781.102 36.608.0 71.27-.102 88.678-.102 77.107.0 382.31-5.888 382.31-373.811.0-84.582-28.979-146.586-76.493-198.195zM513.434 866.048h-2.867c-193.075.0-343.501-22.989-343.501-210.688.0-45.005 15.872-86.682 53.606-121.293 62.822-57.702 169.216-27.187 289.894-27.187.512.0 1.024.0 1.485.0.512.0.922.0 1.382.0 120.678.0 227.123-30.515 289.997 27.187 37.632 34.611 53.504 76.288 53.504 121.293.0 187.699-150.374 210.688-343.501 210.688zM349.235 579.021c-36.762.0-66.56 41.318-66.56 92.109.0 50.893 29.798 92.211 66.56 92.211 36.813.0 66.611-41.318 66.611-92.211.0-50.79-29.798-92.109-66.611-92.109z"/></symbol><symbol id="icon-youtube" viewBox="0 0 1024 1024"><title>youtube</title><path class="path1" d="M512 117.76c-503.194.0-512 44.749-512 394.24s8.806 394.24 512 394.24 512-44.749 512-394.24-8.806-394.24-512-394.24zM676.096 529.101 446.208 636.416c-20.122 9.318-36.608-1.126-36.608-23.347V410.931c0-22.17 16.486-32.666 36.608-23.347l229.888 107.315c20.122 9.421 20.122 24.781.0 34.202z"/></symbol><symbol id="icon-mail" viewBox="0 0 1024 1024"><title>mail</title><path class="path1" d="M80.589 270.643c24.986 13.414 371.098 199.373 384 206.285s29.594 10.189 46.387 10.189c16.794.0 33.485-3.277 46.387-10.189s359.014-192.87 384-206.285c25.037-13.466 48.691-65.843 2.765-65.843H77.875c-45.926.0-22.272 52.378 2.714 65.843zM952.986 383.437c-28.416 14.797-378.214 197.069-395.622 206.182s-29.594 10.189-46.387 10.189-28.979-1.075-46.387-10.189-365.21-191.437-393.626-206.234c-19.968-10.445-19.763 1.792-19.763 11.213s0 373.402.0 373.402c0 21.504 28.979 51.2 51.2 51.2h819.2c22.221.0 51.2-29.696 51.2-51.2.0.0.0-363.93.0-373.35s.205-21.658-19.814-11.213z"/></symbol><symbol id="icon-spotify" viewBox="0 0 1024 1024"><title>spotify</title><path class="path1" d="M512 61.44C263.117 61.44 61.44 263.066 61.44 512c0 248.781 201.677 450.56 450.56 450.56 248.934.0 450.509-201.728 450.509-450.56.0-248.883-201.523-450.56-450.509-450.56zM690.074 742.502c-8.858.0-15.053-3.379-21.555-7.322-60.877-36.915-136.294-56.269-218.01-56.269-41.677.0-86.682 4.966-133.632 14.592l-5.734 1.434c-5.939 1.434-12.032 3.021-16.691 3.021-18.995.0-33.843-14.746-33.843-33.587.0-19.098 10.752-32.614 28.774-35.994 56.115-12.8 108.954-19.046 161.382-19.046 94.976.0 179.866 22.016 252.467 65.485 12.442 7.27 20.275 15.667 20.275 34.202-.051 18.483-15.002 33.485-33.434 33.485zm46.745-131.123c-10.598.0-17.562-4.045-23.706-7.629-109.722-65.075-273.05-86.682-407.603-50.842-2.253.666-4.301 1.28-6.144 1.894-5.069 1.587-9.779 3.174-16.435 3.174-22.118.0-40.09-18.074-40.09-40.346.0-21.453 11.213-36.454 31.437-42.189 51.866-14.234 100.557-23.654 170.65-23.654 113.254.0 223.078 28.416 309.146 79.923 15.667 8.96 22.784 21.197 22.784 39.475.0 22.221-17.971 40.192-40.038 40.192zm53.043-149.504c-9.984.0-16.128-2.406-25.344-7.373-74.394-44.646-190.464-71.219-310.733-71.219-62.669.0-119.603 6.912-169.267 20.326-1.69.41-3.277.87-5.018 1.382-5.274 1.587-11.878 3.482-18.688 3.482-26.419.0-47.053-20.89-47.053-47.565.0-23.194 13.005-40.909 34.816-47.36 59.955-17.715 128.973-26.675 205.107-26.675 137.114.0 267.571 30.464 357.939 83.507 16.998 9.677 25.344 24.32 25.344 44.646.0 26.266-20.685 46.848-47.104 46.848z"/></symbol><symbol id="icon-lastfm" viewBox="0 0 315 315"><title>lastfm</title><path class="path1" d="M264.467 135.355c-2.688-.92-5.289-1.773-7.787-2.594C236.855 126.26 230 123.449 230 112.41c0-9.572 6.799-16.26 16.533-16.26 7.986.0 13.502 3.307 19.039 11.41 2.156 3.158 6.348 4.188 9.721 2.389l19.148-10.205c1.762-.938 3.076-2.541 3.652-4.453.576-1.91.367-3.973-.582-5.729-11.123-20.596-27.912-31.037-49.9-31.037-16.592.0-30.648 5.227-40.654 15.117-9.918 9.803-15.16 23.453-15.16 39.471.0 33.607 21.297 47.508 58.063 60.156 21.045 7.311 25.965 10.137 25.965 21.121.0 13.578-11.727 23.434-27.885 23.434-.486.0-.98-.008-1.48-.025-17.377-.607-22.725-9.088-30.789-28.297-12.947-30.814-28.082-67.734-29.205-70.543-.012-.031-.025-.064-.037-.096-16.416-39.535-49.057-62.209-89.555-62.209C43.457 56.654.0 101.9.0 157.518c0 55.598 43.457 100.828 96.873 100.828 29.217.0 56.559-13.49 75.016-37.014 1.674-2.133 2.064-5.004 1.025-7.508l-11.541-27.781c-1.125-2.711-3.729-4.514-6.66-4.619-2.945-.105-5.654 1.512-6.971 4.135-9.977 19.9-29.469 32.262-50.869 32.262-31.658.0-57.414-27.053-57.414-60.303.0-33.26 25.756-60.32 57.414-60.32 23.029.0 44.1 14.273 52.432 35.516.023.055.045.111.068.166l28.574 67.982 3.293 7.617c13.811 33.602 34.273 48.652 66.359 48.797h.133c38.348.0 67.268-26.699 67.268-62.103C315 159.674 295.66 145.965 264.467 135.355z"/></symbol><symbol id="icon-instagram" viewBox="0 0 1024 1024"><title>instagram</title><path class="path1" d="M870.4 51.2H153.6c-56.32.0-102.4 46.08-102.4 102.4v716.8c0 56.371 46.08 102.4 102.4 102.4h716.8c56.32.0 102.4-46.029 102.4-102.4V153.6c0-56.32-46.08-102.4-102.4-102.4zM511.181 794.778c156.621.0 283.546-127.027 283.546-283.597.0-17.306-2.202-33.997-5.274-50.381H870.4v369.459c0 19.558-15.872 35.328-35.482 35.328H189.081c-19.61.0-35.482-15.77-35.482-35.328V460.8h79.309c-3.123 16.384-5.325 33.075-5.325 50.381.0 156.621 127.027 283.597 283.597 283.597zM333.978 511.181c0-97.894 79.36-177.203 177.254-177.203 97.843.0 177.254 79.309 177.254 177.203s-79.411 177.254-177.254 177.254c-97.946.0-177.254-79.36-177.254-177.254zM834.918 307.2H752.23c-19.558.0-35.43-15.974-35.43-35.43v-82.79c0-19.558 15.872-35.379 35.379-35.379h82.688c19.661.0 35.533 15.821 35.533 35.379v82.739c0 19.507-15.872 35.482-35.482 35.482z"/></symbol><symbol id="icon-linkedin" viewBox="0 0 1024 1024"><title>linkedin</title><path class="path1" d="M256 153.6c0 54.374-36.352 101.171-102.451 101.171-62.208.0-102.349-44.134-102.349-98.509C51.2 100.454 90.112 51.2 153.6 51.2S254.771 97.792 256 153.6zM51.2 972.8V307.2H256v665.6H51.2z"/><path class="path2" d="M358.4 534.733c0-79.104-2.611-145.203-5.222-202.291h184.013l9.114 88.218h3.891c25.907-41.523 89.395-102.4 195.686-102.4 129.638.0 226.918 86.784 226.918 273.51V972.8H768V621.517c0-81.613-31.078-143.872-102.4-143.872-54.374.0-81.613 44.032-95.898 80.333-5.222 13.005-6.502 31.13-6.502 49.306v365.517H358.4V534.734z"/></symbol><symbol id="icon-google" viewBox="0 0 1024 1024"><title>google</title><path class="path1" d="M522.2 438.8v175.6h290.4c-11.8 75.4-87.8 220.8-290.4 220.8-174.8.0-317.4-144.8-317.4-323.2s142.6-323.2 317.4-323.2c99.4.0 166 42.4 204 79l139-133.8C776 50.4 660.4.0 522.2.0c-283 0-512 229-512 512s229 512 512 512c295.4.0 491.6-207.8 491.6-500.2.0-33.6-3.6-59.2-8-84.8l-483.6-.2z"/></symbol><symbol id="icon-google-plus" viewBox="0 0 1317 1024"><title>google-plus</title><path class="path1" d="M821.143 521.714q0 118.857-49.714 211.714T629.715 878.571t-210.857 52.286q-85.143.0-162.857-33.143t-133.714-89.143-89.143-133.714-33.143-162.857 33.143-162.857 89.143-133.714 133.714-89.143 162.857-33.143q163.429.0 280.571 109.714L585.715 312q-66.857-64.571-166.857-64.571-70.286.0-130 35.429t-94.571 96.286-34.857 132.857 34.857 132.857 94.571 96.286 130 35.429q47.429.0 87.143-13.143t65.429-32.857 44.857-44.857 28-47.429 12.286-42.286H418.859v-144h395.429q6.857 36 6.857 69.714zM1316.571 452v120h-119.429v119.429h-120V572H957.713V452h119.429V332.571h120V452h119.429z"/></symbol><symbol id="icon-pinterest" viewBox="0 0 1024 1024"><title>pinterest</title><path class="path1" d="M512 68.4C267 68.4 68.4 267 68.4 512c0 188 117 348.4 282 413-3.8-35-7.4-89 1.6-127.2 8-34.6 52-220.4 52-220.4s-13.2-26.6-13.2-65.8c0-61.6 35.8-107.8 80.2-107.8 37.8.0 56.2 28.4 56.2 62.4.0 38-24.2 95-36.8 147.6-10.6 44.2 22 80.2 65.6 80.2 78.8.0 139.4-83.2 139.4-203.2.0-106.2-76.4-180.4-185.2-180.4C384 310.4 310 405 310 503c0 38.2 14.6 79 33 101.2 3.6 4.4 4.2 8.2 3 12.8-3.4 14-10.8 44.2-12.4 50.4-2 8.2-6.4 9.8-14.8 6-55.4-25.8-90-106.8-90-171.8.0-140 101.6-268.4 293-268.4 153.8.0 273.4 109.6 273.4 256.2.0 152.8-96.4 276-230.2 276-45 0-87.2-23.4-101.6-51 0 0-22.2 84.6-27.6 105.4-10 38.6-37 86.8-55.2 116.2 41.6 12.8 85.6 19.8 131.4 19.8 245 0 443.6-198.6 443.6-443.6.0-245.2-198.6-443.8-443.6-443.8z"/></symbol><symbol id="icon-medium" viewBox="0 0 179.2 179.2"><title>medium</title><path transform="scale(0.1,-0.1) translate(0,-1536)" d="M597 1115V-58q0-25-12.5-42.5T548-118q-17 0-33 8L50 123q-21 10-35.5 33.5T0 203v1140q0 20 10 34t29 14q14 0 44-15l511-256q3-3 3-5zm64-101 534-866-534 266v6e2zm1131-18V-58q0-25-14-40.5t-38-15.5-47 13l-441 220zm-3 120q0-3-256.5-419.5T1232 209L842 843l324 527q17 28 52 28 14 0 26-6l541-270q4-2 4-6z"/></symbol><symbol id="icon-vimeo" viewBox="0 0 21 21"><title>vimeo</title><path d="M17.811 2.018c2.017.053 3.026 1.198 3.036 3.438.0.147-.005.3-.013.457-.089 1.899-1.502 4.486-4.245 7.76-2.829 3.43-5.229 5.147-7.2 5.156-1.226.0-2.244-1.05-3.061-3.151l-.858-2.88-.848-2.876C3.997 7.838 3.329 6.798 2.616 6.798c-.156.0-.697.304-1.626.91L0 6.537l1.536-1.276 1.511-1.263C4.4 2.914 5.429 2.328 6.135 2.241c.094-.01.188-.013.284-.013 1.449.0 2.354 1.041 2.709 3.124C9.326 6.54 9.49 7.506 9.623 8.248 9.752 8.992 9.86 9.51 9.946 9.805c.479 1.97.995 2.96 1.55 2.968.426.0 1.082-.642 1.968-1.926.866-1.319 1.332-2.296 1.392-2.932.019-.129.026-.25.026-.362.0-.861-.474-1.29-1.418-1.29-.479.0-.99.102-1.537.299.98-3.021 2.864-4.534 5.65-4.544C17.655 2.018 17.732 2.018 17.811 2.018z"/></symbol><symbol id="icon-stackoverflow" viewBox="0 0 878 1024"><title>stackoverflow</title><path class="path1" d="M736.571 932.571h-638.857V658.285h-91.429v365.714h821.714V658.285H736.57v274.286zM198.286 633.143l18.857-89.714 447.429 94.286-18.857 89.143zm58.857-213.714L295.429 336l414.286 193.714-38.286 82.857zM372 216l58.286-70.286 350.857 293.143-58.286 70.286zM598.857.0l272.571 366.286-73.143 54.857L525.714 54.857zM188.571 840.571v-90.857h457.143v90.857H188.571z"/></symbol><symbol id="icon-reddit" viewBox="0 0 1024 1024"><title>reddit</title><path class="path1" d="M1024 483.429q0 33.143-16.857 60.286t-45.429 41.429q6.857 26.286 6.857 54.857.0 88.571-60.857 164t-166 119.143-228.571 43.714-228.286-43.714-165.714-119.143-60.857-164q0-26.857 6.286-53.714-29.143-14.286-46.857-42t-17.714-60.857q0-46.857 33.143-80.286t80.571-33.429q48.571.0 82.857 36 124.571-86.857 294.286-92.571L557.144 15.43q1.714-7.429 8.571-12t14.857-2.857l210.857 46.286q10.286-21.143 30.857-34t45.143-12.857q35.429.0 60.571 24.857t25.143 60.286T928 145.716t-60.571 25.143-60.286-24.857-24.857-60.286L591.429 43.43 532 313.144q171.429 5.143 296.571 91.429 33.143-34.857 81.714-34.857 47.429.0 80.571 33.429t33.143 80.286zM238.857 597.143q0 35.429 24.857 60.571T324 682.857t60.571-25.143 25.143-60.571-25.143-60.286T324 512q-34.857.0-60 25.143t-25.143 60zM701.714 8e2Q708 793.714 708 785.143t-6.286-14.857q-5.714-5.714-14.286-5.714t-14.857 5.714q-23.429 24-69.143 35.429t-91.429 11.429-91.429-11.429-69.143-35.429q-6.286-5.714-14.857-5.714t-14.286 5.714q-6.286 5.714-6.286 14.571T322.284 8e2q24.571 24.571 67.714 38.857t70 16.857 52 2.571 52-2.571 70-16.857T701.712 8e2zM7e2 682.857q35.429.0 60.286-25.143t24.857-60.571q0-34.857-25.143-60T7e2 512q-35.429.0-60.571 24.857t-25.143 60.286 25.143 60.571T7e2 682.857z"/></symbol><symbol id="icon-quora" viewBox="0 0 76 76"><title>quora</title><path class="path1" d="M67.9 59.1s-.4 5.3-5.2 5.3c-3.7.0-6.3-2.8-8.7-6.5 6.8-5.9 11.1-14.7 11.1-24.6C65.1 15.4 51.1 1 33.8 1S2.6 15.4 2.6 33.2s14 32.2 31.3 32.2c3.1.0 6.2-.5 9-1.4 3.6 5.8 8.1 11 15.3 11 14.6.0 15.2-15.9 15.2-15.9H67.9zM33.8 60.2c-10.1.0-18.2-12.1-18.2-26.9s8.2-27 18.2-27S52 18.4 52 33.2c0 5.9-1.3 11.4-3.5 15.8-2.5-3.5-5.4-6.5-9.7-7.5-7.5-1.7-14 1.7-16.1 3.4l1.9 4s2-1.1 6.8.0c3.1.7 5.4 4.9 8.1 9.8C37.9 59.7 35.9 60.2 33.8 60.2z"/></symbol><symbol id="icon-microphone" viewBox="-8 -4 34 37"><title>quora</title><path clip-rule="evenodd" d="M10.8 22.8V26h5v2h-5-3-5v-2h5v-3.2C3.4 22.2.0 18.7.0 14.4v-3c0-.1.0-.3.0-.4h2.8c0 .3-.1.6-.1.9V14c0 3.3 2.9 6 6.5 6s6.5-2.7 6.5-6v-2.1c0-.3.0-.6-.1-.9h2.8c0 .1.0.3.0.4v3C18.6 18.7 15.2 22.2 10.8 22.8zM9.3 18c-2.5.0-4.5-2-4.5-4.5v-9C4.8 2 6.8.0 9.3.0s4.5 2 4.5 4.5v9c0 2.5-2 4.5-4.5 4.5z" fill="#0d0d0d" fill-rule="evenodd"/></symbol></defs></svg></html>